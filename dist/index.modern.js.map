{"version":3,"file":"index.modern.js","sources":["../src/io/Loader.ts","../src/compression/DataType.ts","../src/compression/TokenEncoder.ts","../src/reducer/Reducer.ts","../src/compression/FFlateEncoder.ts","../src/tokenizer/Token.ts","../src/tokenizer/Tokenizer.ts","../src/expander/Extractor.ts","../src/compression/Compressor.ts","../src/index.tsx"],"sourcesContent":["import fetch from \"cross-fetch\";\nconst yaml = require('js-yaml');\n\nfunction extension(file: string) {\n    return file.split(\".\").pop();\n}\n\nexport type IFetcher<T> = (file: string) => Promise<T>;\n\nexport default class Loader {\n    async load(file: string, fetcher?: IFetcher<string>): Promise<any> {\n        const text = await (fetcher ?? Loader.BrowserFetcher)(file);\n        if (extension(file) === \"yaml\" || extension(file) === \"yml\") {\n            return yaml.load(text);\n        }\n        return extension(file) === \"json\" ? JSON.parse(text) : text;\n    }\n\n    static BrowserFetcher: IFetcher<string> = (file: string): Promise<string> => {\n        return fetch(file).then(response => response.text());\n    }\n\n    static ArrayBufferFetcher:IFetcher<ArrayBuffer> = (file: string): Promise<ArrayBuffer> => {\n        return fetch(file).then(response => response.arrayBuffer());\n    }\n}\n","import Token, { StoredToken, Type } from \"../tokenizer/Token\";\n\nexport enum StructureType {\n    LEAF = 0,\n    ARRAY = 1,\n    OBJECT = 2,\n    SPLIT = 3,\n};\n\nexport enum DataType {\n    UNDEFINED = 0,\n    NULL = 1,\n    BOOLEAN_FALSE = 2,\n    BOOLEAN_TRUE = 3,\n    INT8 = 4,\n    UINT8 = 5,\n    INT16 = 6,\n    UINT16 = 7,\n    INT32 = 8,\n    UINT32 = 9,\n    FLOAT32 = 10,\n    FLOAT64 = 11,\n    STRING = 12,\n    UNICODE = 13,\n    OBJECT_8 = 17,\n    OBJECT_16 = 18,\n    OBJECT_32 = 19,\n    SPLIT_8 = 20,\n    SPLIT_16 = 21,\n    SPLIT_32 = 22,\n    ARRAY_8 = 23,\n    ARRAY_16 = 24,\n    ARRAY_32 = 25,\n    OFFSET_ARRAY_8 = 26,\n    OFFSET_ARRAY_16 = 27,\n    OFFSET_ARRAY_32 = 28,\n    EMPTY_ARRAY = 29,\n    REFERENCE_8 = 30,\n    REFERENCE_16 = 31,\n    REFERENCE_32 = 32,\n    COMPLEX_OBJECT = 33,\n    UINT2 = 34,\n    UINT4 = 35,\n}\n\nexport const NUMBER_DATA_TYPES = [\n    DataType.UINT8,\n    DataType.INT8,\n    DataType.UINT16,\n    DataType.INT16,\n    DataType.UINT32,\n    DataType.INT32,\n    DataType.FLOAT32,\n    DataType.FLOAT64,\n];\n\nexport class DataTypeUtils {\n    numberSatisfyDataType(value: number, dataType: DataType): boolean {\n        const hasDecimal = value % 1 !== 0;\n        if (hasDecimal) {\n            switch(dataType) {\n                case DataType.FLOAT32:\n                    return Math.fround(value) === value;\n                case DataType.FLOAT64:\n                    return true;\n                default:\n                    return false;\n            }\n        }\n        switch (dataType) {\n            case DataType.UINT2:\n                return value >= 0 && value < 4;\n            case DataType.UINT4:\n                return value >= 0 && value < 16;\n            case DataType.UINT8:\n                return value >= 0 && value <= 255;\n            case DataType.INT8:\n                return value >= -128 && value <= 127;\n            case DataType.UINT16:\n                return value >= 0 && value <= 65535;\n            case DataType.INT16:\n                return value >= -32768 && value <= 32767;\n            case DataType.UINT32:\n                return value >= 0;\n            case DataType.INT32:\n                return true;\n            case DataType.FLOAT32:\n                return Math.fround(value) === value;\n            case DataType.FLOAT64:\n                return true;\n        }\n        return false;\n    }\n\n    getBestType(array: number[]): DataType {\n        if (array.some(number => number % 1 !== 0)) {\n            //  decimal\n            if (array.every(number => this.numberSatisfyDataType(number, DataType.FLOAT32))) {\n                return DataType.FLOAT32;\n            }\n            return DataType.FLOAT64;\n        }\n\n        const min = Math.min(...array);\n        const max = Math.max(...array);\n\n        for (const dataType of NUMBER_DATA_TYPES) {\n            if (this.numberSatisfyDataType(min, dataType) && this.numberSatisfyDataType(max, dataType)) {\n                return dataType;\n            }\n        }\n        return DataType.FLOAT64;\n    }\n\n\n    getNumberDataType(value: number): DataType {\n        for (const type of NUMBER_DATA_TYPES) {\n            if (this.numberSatisfyDataType(value, type)) {\n                return type;\n            }\n        }\n        return DataType.UNDEFINED;\n    }\n\n    getStringDataType(value: string): DataType {\n        const letterCodes = value.split(\"\").map(l => l.charCodeAt(0));\n\n        if (letterCodes.every(code => code <= 255)) {\n            return DataType.STRING;\n        } else {\n            return DataType.UNICODE;\n        }    \n    }\n\n    getFullTokenDataType(token: Token): DataType {\n        switch (token.type) {\n            case \"array\":\n                return DataType.ARRAY_8;\n            case \"object\":\n                return DataType.OBJECT_8;\n            case \"split\":\n                return DataType.SPLIT_8;\n            default:\n                return this.getDataType(token);\n        }\n    }\n\n    getDataType(token: StoredToken): DataType {\n        switch (token.type) {\n            case \"complex\":\n                return DataType.COMPLEX_OBJECT;\n            case \"array\":\n            case \"object\":\n            case \"split\":\n                let indices: number[] = token.value;\n                if (!indices.length) {\n                    console.assert(token.type === \"array\");\n                    return DataType.EMPTY_ARRAY;\n                }\n                let offset = 0;\n                if (token.type === \"array\" && indices.length > 3) {\n                    const min = Math.min(...indices);\n                    const max = Math.max(...indices);\n                    if (this.getNumberDataType(max - min) !== this.getNumberDataType(max)) {\n                        offset = min;\n                    }\n                    indices = indices.map(value => value - offset);\n                }\n                const bestType: DataType = this.getBestType(indices);\n                switch (token.type) {\n                    case \"object\":\n                        return bestType === DataType.UINT8\n                            ? DataType.OBJECT_8\n                            : bestType === DataType.UINT16\n                            ? DataType.OBJECT_16\n                            : DataType.OBJECT_32;\n                    case \"split\":\n                        return bestType === DataType.UINT8\n                            ? DataType.SPLIT_8\n                            : bestType === DataType.UINT16\n                            ? DataType.SPLIT_16\n                            : DataType.SPLIT_32;\n                    case \"array\":\n                        if (offset) {\n                            return bestType === DataType.UINT8\n                                ? DataType.OFFSET_ARRAY_8\n                                : bestType === DataType.UINT16\n                                ? DataType.OFFSET_ARRAY_16\n                                : DataType.OFFSET_ARRAY_32;\n                        } else {\n                            return bestType === DataType.UINT8\n                                ? DataType.ARRAY_8\n                                : bestType === DataType.UINT16\n                                ? DataType.ARRAY_16\n                                : DataType.ARRAY_32;\n                        }\n                }\n            case \"leaf\":\n                if (token.value === undefined) {\n                    return DataType.UNDEFINED;\n                } else if (token.value === null) {\n                    return DataType.NULL;\n                } else {\n                    switch (typeof token.value) {\n                        case \"boolean\":\n                            return token.value ? DataType.BOOLEAN_TRUE : DataType.BOOLEAN_FALSE;\n                        case \"string\":\n                            return this.getStringDataType(token.value);\n                        case \"number\":\n                            return this.getNumberDataType(token.value);\n                    }    \n                }\n                break;\n            case \"reference\":\n                switch(this.getNumberDataType(token.value)) {\n                    case DataType.UINT8:\n                        return DataType.REFERENCE_8;\n                    case DataType.UINT16:\n                        return DataType.REFERENCE_16;\n                    case DataType.UINT32:\n                        return DataType.REFERENCE_32;\n                }\n                throw new Error(\"Invalid reference value: \" + token.value);\n        }\n        throw new Error(`Unrecognized type for ${token.type} value: ${token.value}`);\n    }\n\n    dataTypeToType(dataType: DataType): Type {\n        switch(dataType) {\n            case DataType.COMPLEX_OBJECT:\n                return \"complex\";\n            case DataType.EMPTY_ARRAY:\n            case DataType.ARRAY_8:\n            case DataType.ARRAY_16:\n            case DataType.ARRAY_32:\n                return \"array\";\n            case DataType.OBJECT_8:\n            case DataType.OBJECT_16:\n            case DataType.OBJECT_32:\n                return \"object\";\n            case DataType.SPLIT_8:\n            case DataType.SPLIT_16:\n            case DataType.SPLIT_32:\n                return \"split\";\n            case DataType.REFERENCE_8:\n            case DataType.REFERENCE_16:\n            case DataType.REFERENCE_32:\n                return \"reference\";\n            default:\n                return \"leaf\";\n        }\n    }\n\n    typeToStructureType(type: Type): StructureType {\n        switch (type) {\n            case \"leaf\":\n                return StructureType.LEAF;\n            case \"array\":\n                return StructureType.ARRAY;\n            case \"object\":\n                return StructureType.OBJECT;\n            case \"split\":\n                return StructureType.SPLIT;\n        }\n        throw new Error(\"Cannot translate to structure type: \" + type);\n    }\n}","//13093\nimport { StreamDataView } from \"stream-data-view\";\nimport { ReducedToken } from \"../tokenizer/Token\";\nimport { DataType, DataTypeUtils } from \"./DataType\";\n\ntype Tester = (encoder: TokenEncoder, decoder: TokenEncoder, reset: () => void) => void;\n\ninterface MultiInfo {\n    organized: boolean;\n    lastStringLength?: number;\n}\n\nconst MAX_ARRAY_SIZE = 255;\n\nexport default class TokenEncoder {\n    streamDataView: StreamDataView;\n    dataTypeUtils: DataTypeUtils;\n\n    constructor(streamDataView: StreamDataView) {\n        this.streamDataView = streamDataView;\n        this.dataTypeUtils = new DataTypeUtils();\n    }\n\n    encodeTokens(tokens: ReducedToken[], organized: boolean) {\n        let pos = 0;\n        while (pos < tokens.length) {\n            const count = this.encodeMulti(tokens, pos, organized);\n            if (count) {\n                pos += count;\n            }\n        }\n        this.encodeMulti([], pos, organized);\n    }\n\n    decodeTokens(organized: boolean) {\n        const tokens:  ReducedToken[] = [];\n        while(this.streamDataView.getOffset() < this.streamDataView.getLength()) {\n            if (!this.decodeMulti(tokens, organized)) {\n                break;\n            }\n        }\n        return tokens;\n    }\n\n    encodeToken(token: ReducedToken, dataType?: DataType, multiInfo?: MultiInfo): void {\n        const usedDataType: DataType = dataType ?? this.encodeDataType(this.dataTypeUtils.getDataType(token));\n        switch (usedDataType) {\n            case DataType.UNDEFINED:\n            case DataType.NULL:\n            case DataType.BOOLEAN_TRUE:\n            case DataType.BOOLEAN_FALSE:\n            case DataType.EMPTY_ARRAY:\n                break;\n            case DataType.INT8:\n            case DataType.UINT8:\n            case DataType.INT16:\n            case DataType.UINT16:\n            case DataType.INT32:\n            case DataType.UINT32:\n            case DataType.FLOAT32:\n            case DataType.FLOAT64:\n                this.encodeSingleNumber(token.value, usedDataType);\n                break;\n            case DataType.STRING:\n            case DataType.UNICODE:\n                this.encodeString(token.value, usedDataType, multiInfo);\n                break;\n            case DataType.OBJECT_8:\n            case DataType.OBJECT_16:\n            case DataType.OBJECT_32:\n                this.encodeObjectToken(token, usedDataType);\n                break;\n            case DataType.SPLIT_8:\n            case DataType.SPLIT_16:\n            case DataType.SPLIT_32:\n                this.encodeSplitToken(token, usedDataType);\n                break;\n            case DataType.ARRAY_8:\n            case DataType.ARRAY_16:\n            case DataType.ARRAY_32:\n            case DataType.OFFSET_ARRAY_8:\n            case DataType.OFFSET_ARRAY_16:\n            case DataType.OFFSET_ARRAY_32:\n                this.encodeArrayToken(token, usedDataType);\n                break;\n            case DataType.REFERENCE_8:\n            case DataType.REFERENCE_16:\n            case DataType.REFERENCE_32:\n                this.encodeReferenceToken(token, usedDataType);\n                break;\n            case DataType.COMPLEX_OBJECT:\n                this.encodeComplexToken(token, usedDataType);\n                break;\n            default:\n                throw new Error(\"Invalid dataType: \" + usedDataType);\n            }\n    }\n\n    decodeToken(dataType?: DataType, multiInfo?: MultiInfo): ReducedToken {\n        const usedDataType = dataType ?? this.decodeDataType();\n        switch (usedDataType) {\n            case DataType.UNDEFINED:\n                return { type: \"leaf\", value: undefined };\n            case DataType.NULL:\n                return { type: \"leaf\", value: null };\n            case DataType.BOOLEAN_TRUE:\n                return { type: \"leaf\", value: true };\n            case DataType.BOOLEAN_FALSE:\n                return { type: \"leaf\", value: false };\n            case DataType.EMPTY_ARRAY:\n                return { type: \"array\", value: [] };\n            case DataType.UINT2:\n            case DataType.UINT4:\n                    throw new Error(\"Use decode number array.\");\n            case DataType.INT8:\n            case DataType.UINT8:\n            case DataType.INT16:\n            case DataType.UINT16:\n            case DataType.INT32:\n            case DataType.UINT32:\n            case DataType.FLOAT32:\n            case DataType.FLOAT64:\n                return { type: \"leaf\", value: this.decodeSingleNumber(usedDataType) };\n            case DataType.STRING:\n            case DataType.UNICODE:\n                return { type: \"leaf\", value: this.decodeString(usedDataType, multiInfo) };\n            case DataType.OBJECT_8:\n            case DataType.OBJECT_16:\n            case DataType.OBJECT_32:\n                return this.decodeObjectToken(usedDataType);\n            case DataType.SPLIT_8:\n            case DataType.SPLIT_16:\n            case DataType.SPLIT_32:\n                return this.decodeSplitToken(usedDataType);\n            case DataType.ARRAY_8:\n            case DataType.ARRAY_16:\n            case DataType.ARRAY_32:\n            case DataType.OFFSET_ARRAY_8:\n            case DataType.OFFSET_ARRAY_16:\n            case DataType.OFFSET_ARRAY_32:\n                return this.decodeArrayToken(usedDataType);\n            case DataType.REFERENCE_8:\n            case DataType.REFERENCE_16:\n            case DataType.REFERENCE_32:\n                return this.decodeReferenceToken(usedDataType);\n            case DataType.COMPLEX_OBJECT:\n                    return this.decodeComplexToken(usedDataType);\n            default:\n                throw new Error(\"Invalid dataType: \" + usedDataType);\n        }\n    }\n\n    isOffsetDataType(dataType: DataType) {\n        return dataType === DataType.OFFSET_ARRAY_8 || dataType === DataType.OFFSET_ARRAY_16 || dataType === DataType.OFFSET_ARRAY_32;\n    }\n\n    encodeArrayToken(arrayToken: ReducedToken, dataType?: DataType) {\n        const usedDataType = dataType ?? this.encodeDataType(this.dataTypeUtils.getDataType(arrayToken));\n        const numberType = usedDataType === DataType.ARRAY_8 || usedDataType === DataType.OFFSET_ARRAY_8\n            ? DataType.UINT8\n            : usedDataType === DataType.ARRAY_16 || usedDataType === DataType.OFFSET_ARRAY_16\n            ? DataType.UINT16 : DataType.UINT32;\n\n        let indices = arrayToken.value;\n        if (this.isOffsetDataType(usedDataType)) {\n            const offset = Math.min(...indices);\n            indices = indices.map((value: number) => value - offset);\n            this.encodeSingleNumber(offset);\n        }\n\n        this.encodeNumberArray(indices, numberType);\n    }\n\n    decodeArrayToken(dataType?: DataType): ReducedToken {\n        const usedDataType = dataType ?? this.decodeDataType();\n\n        let offset = 0;\n        if (this.isOffsetDataType(usedDataType)) {\n            offset = this.decodeSingleNumber();\n        }\n\n        const numberType = usedDataType === DataType.ARRAY_8 || usedDataType === DataType.OFFSET_ARRAY_8\n            ? DataType.UINT8\n            : usedDataType === DataType.ARRAY_16 || usedDataType === DataType.OFFSET_ARRAY_16\n            ? DataType.UINT16 : DataType.UINT32;\n        const indices = this.decodeNumberArray(numberType)\n            .map(value => value + offset);\n        return {\n            type: \"array\",\n            value: indices,\n        }\n    }\n\n    encodeObjectToken(objectToken: ReducedToken, dataType?: DataType) {\n        const usedDataType = dataType ?? this.encodeDataType(this.dataTypeUtils.getDataType(objectToken));\n        const numberType = usedDataType === DataType.OBJECT_8 ? DataType.UINT8 : usedDataType === DataType.OBJECT_16 ? DataType.UINT16 : DataType.UINT32;\n        const [keysIndex, valuesIndex] = objectToken.value;\n        this.encodeSingleNumber(keysIndex, numberType);\n        this.encodeSingleNumber(valuesIndex, numberType);\n    }\n\n    decodeObjectToken(dataType?: DataType): ReducedToken {\n        const usedDataType = dataType ?? this.decodeDataType();\n        const numberType = usedDataType === DataType.OBJECT_8 ? DataType.UINT8 : usedDataType === DataType.OBJECT_16 ? DataType.UINT16 : DataType.UINT32;\n        return {\n            type: \"object\",\n            value: [this.decodeSingleNumber(numberType), this.decodeSingleNumber(numberType)],\n        };\n    }\n\n    encodeSplitToken(splitToken: ReducedToken, dataType?: DataType) {\n        const usedDataType = dataType ?? this.encodeDataType(this.dataTypeUtils.getDataType(splitToken));\n        const numberType = usedDataType === DataType.SPLIT_8 ? DataType.UINT8 : usedDataType === DataType.SPLIT_16 ? DataType.UINT16 : DataType.UINT32;\n        const [chunksIndex, separatorsIndex] = splitToken.value;\n        this.encodeSingleNumber(chunksIndex, numberType);\n        this.encodeSingleNumber(separatorsIndex, numberType);\n    }\n\n    decodeSplitToken(dataType?: DataType): ReducedToken {\n        const usedDataType = dataType ?? this.decodeDataType();\n        const numberType = usedDataType === DataType.SPLIT_8 ? DataType.UINT8 : usedDataType === DataType.SPLIT_16 ? DataType.UINT16 : DataType.UINT32;\n        return {\n            type: \"split\",\n            value: [this.decodeSingleNumber(numberType), this.decodeSingleNumber(numberType)],\n        };\n    }\n\n    encodeReferenceToken(token: ReducedToken, dataType?: DataType) {\n        const usedDataType = dataType ?? this.encodeDataType(this.dataTypeUtils.getDataType(token));\n        const numberType = usedDataType === DataType.REFERENCE_8 ? DataType.UINT8 : usedDataType === DataType.REFERENCE_16 ? DataType.UINT16 : DataType.UINT32;\n        const index = token.value;\n        this.encodeSingleNumber(index, numberType);\n    }\n\n    decodeReferenceToken(dataType?: DataType): ReducedToken {\n        const usedDataType = dataType ?? this.decodeDataType();\n        const numberType = usedDataType === DataType.REFERENCE_8 ? DataType.UINT8 : usedDataType === DataType.REFERENCE_16 ? DataType.UINT16 : DataType.UINT32;\n        return {\n            type: \"reference\",\n            value: this.decodeSingleNumber(numberType),\n        };\n    }\n\n    encodeComplexToken(token: ReducedToken, dataType?: DataType) {\n        if (dataType === undefined) {\n            this.encodeDataType(this.dataTypeUtils.getDataType(token));\n        }\n        const structure = token.value;\n        this.encodeNumberArray(structure, DataType.UINT2);\n    }\n\n    decodeComplexToken(dataType?: DataType): ReducedToken {\n        const usedDataType = dataType ?? this.decodeDataType();\n        const structure = this.decodeNumberArray(DataType.UINT2);\n        return {\n            type: this.dataTypeUtils.dataTypeToType(usedDataType),\n            value: structure,\n        };\n    }\n\n    encodeDataType(dataType: DataType): DataType {\n        this.streamDataView.setNextUint8(dataType);\n        return dataType;\n    }\n\n    decodeDataType(): DataType {\n        const dataType = this.streamDataView.getNextUint8();\n        return dataType;\n    }\n\n    encodeMulti(tokens: ReducedToken[], pos: number, organized: boolean): number {\n        if (pos >= tokens.length) {\n            this.encodeSingleNumber(0, DataType.UINT8);\n            return 0;\n        }\n        const firstType = this.dataTypeUtils.getDataType(tokens[pos]);\n        let multiCount;\n        const maxCount = Math.min(tokens.length - pos, 255);\n        for (multiCount = 1; multiCount < maxCount; multiCount++) {\n            if (this.dataTypeUtils.getDataType(tokens[pos + multiCount]) !== firstType) {\n                break;\n            }\n        }\n        //  encode a multi, meaning that the same type is going to get repeated multiple times\n        this.encodeSingleNumber(multiCount, DataType.UINT8);\n        this.encodeDataType(firstType);\n        const multiInfo: MultiInfo = { organized };\n        for (let i = 0; i < multiCount; i++) {\n            this.encodeToken(tokens[pos + i], firstType, multiInfo);\n        }\n        return multiCount;\n    }\n\n    decodeMulti(tokens: ReducedToken[], organized: boolean): number {\n        const count = this.streamDataView.getNextUint8();\n        if (!count) {\n            return 0;\n        }\n        const dataType = this.decodeDataType();\n        const multiInfo: MultiInfo = { organized };\n        for (let i = 0; i < count; i++) {\n            const token = this.decodeToken(dataType, multiInfo);\n            tokens.push(token);\n        }\n        return count;\n    }\n\n    encodeSingleNumber(value: number, dataType?: DataType) {\n        const usedDataType = dataType ?? this.encodeDataType(this.dataTypeUtils.getNumberDataType(value));\n\n        switch (usedDataType) {\n            case DataType.UINT2:\n            case DataType.UINT4:\n                    throw new Error(\"Use encode number array.\");\n            case DataType.UINT8:\n                this.streamDataView.setNextUint8(value);\n                break;\n            case DataType.INT8:\n                this.streamDataView.setNextInt8(value);\n                break;\n            case DataType.UINT16:\n                this.streamDataView.setNextUint16(value);\n                break;\n            case DataType.INT16:\n                this.streamDataView.setNextInt16(value);\n                break;\n            case DataType.UINT32:\n                this.streamDataView.setNextUint32(value);\n                break;\n            case DataType.INT32:\n                this.streamDataView.setNextInt32(value);\n                break;\n            case DataType.FLOAT32:\n                this.streamDataView.setNextFloat32(value);\n                break;\n            case DataType.FLOAT64:\n                this.streamDataView.setNextFloat64(value);\n                break;\n            default:\n                throw new Error(\"Invalid dataType for number: \" + usedDataType);\n        }\n    }\n\n    decodeSingleNumber(dataType?: DataType): number {\n        const usedDataType = dataType ?? this.decodeDataType();\n\n        switch (usedDataType) {\n            case DataType.UINT2:\n            case DataType.UINT4:\n                 throw new Error(\"Use decode number array.\");\n            case DataType.UINT8:\n                return this.streamDataView.getNextUint8();\n            case DataType.INT8:\n                return this.streamDataView.getNextInt8();\n            case DataType.UINT16:\n                return this.streamDataView.getNextUint16();\n            case DataType.INT16:\n                return this.streamDataView.getNextInt16();\n            case DataType.UINT32:\n                return this.streamDataView.getNextUint32();\n            case DataType.INT32:\n                return this.streamDataView.getNextInt32();\n            case DataType.FLOAT32:\n                return this.streamDataView.getNextFloat32();\n            case DataType.FLOAT64:\n                return this.streamDataView.getNextFloat64();\n            default:\n                throw new Error(\"Invalid dataType for number: \" + usedDataType);\n        }\n    }\n\n    bit2ToNum([a, b, c, d]: number[]): number {\n        return ((a ?? 0) << 0) | ((b ?? 0) << 2) | ((c ?? 0) << 4) | ((d ?? 0) << 6);\n    }\n\n    numToBit2(n: number, size: number = 4): number[] {\n        return [(n >> 0) & 3, (n >> 2) & 3, (n >> 4) & 3, (n >> 6) & 3].slice(0, size);\n    }\n\n    bit4ToNum([a, b]: number[]): number {\n        return ((a ?? 0) << 0) | ((b ?? 0) << 4);\n    }\n\n    numToBit4(n: number, size: number = 2): number[] {\n        return [(n >> 0) & 15, (n >> 4) & 15].slice(0, size);\n    }\n\n    encodeNumberArray(array: number[], dataType?: DataType) {\n        if (dataType === DataType.UINT2 || dataType === DataType.UINT4) {\n            const stride = dataType === DataType.UINT2 ? 4 : 2;\n            const transform = dataType === DataType.UINT2 ? this.bit2ToNum : this.bit4ToNum;\n            const bytes = [];\n            for (let i = 0; i < array.length; i += stride) {\n                bytes.push(transform(array.slice(i, i + stride)));\n            }\n            this.encodeNumberArray(bytes, DataType.UINT8);\n            this.encodeSingleNumber(array.length - bytes.length * stride, DataType.INT8);\n            return;\n        }\n\n        let pos;\n        for (pos = 0; pos < array.length;) {\n            const size = Math.min(MAX_ARRAY_SIZE, array.length - pos);\n            this.encodeSingleNumber(size, DataType.UINT8);\n            if (!size) {\n                break;\n            }\n\n            const bestType: DataType = dataType ?? this.encodeDataType(this.dataTypeUtils.getBestType(array));\n\n            for (let i = 0; i < size; i++) {\n                this.encodeSingleNumber(array[pos + i], bestType);\n            }    \n\n            pos += size;\n        }\n        if (pos === MAX_ARRAY_SIZE) {\n            //  Reached the max size, but the next one is 0.\n            this.encodeSingleNumber(0, DataType.UINT8);\n        }\n    }\n\n    decodeNumberArray(dataType?: DataType): number[] {\n        if (dataType === DataType.UINT2 || dataType === DataType.UINT4) {\n            const transform = dataType === DataType.UINT2 ? this.numToBit2 : this.numToBit4;\n            const structure = [];\n            const bytes = this.decodeNumberArray(DataType.UINT8);\n            for (let byte of bytes) {\n                structure.push(...transform(byte));\n            }\n            const sizeDiff = this.decodeSingleNumber(DataType.INT8);\n            structure.length += sizeDiff;\n            return structure;                \n        }\n        let size;\n        const numbers = [];\n        do {\n            size = this.decodeSingleNumber(DataType.UINT8);\n            if (!size) {\n                break;\n            }\n\n            const type: DataType = dataType ?? this.decodeDataType();\n            for (let i = 0; i < size; i++) {\n                numbers.push(this.decodeSingleNumber(type));\n            }    \n        } while (size >= MAX_ARRAY_SIZE);\n        return numbers;\n    }\n\n    encodeString(value: string, dataType?: DataType, multiInfo?: MultiInfo): void {\n        const usedDataType = dataType ?? this.encodeDataType(this.dataTypeUtils.getStringDataType(value));\n        const letterCodes = value.split(\"\").map(l => l.charCodeAt(0));\n        if (!multiInfo?.organized || multiInfo.lastStringLength !== value.length) {\n            letterCodes.push(0);\n        }\n        // console.log(letterCodes, value, (letterCodes).map((value) => !value ? 0 : value - min + 1));\n        const numberType = usedDataType === DataType.STRING ? DataType.UINT8 : DataType.UINT16;\n        letterCodes.forEach(code => this.encodeSingleNumber(code, numberType));\n        if (multiInfo) {\n            multiInfo.lastStringLength = value.length;\n        }\n    }\n\n    decodeString(dataType?: DataType, multiInfo?: MultiInfo): string {\n        const usedDataType = dataType ?? this.decodeDataType();\n        const charCodes = [];\n        const numberType = usedDataType === DataType.STRING ? DataType.UINT8 : DataType.UINT16;\n        do {\n            const code = this.decodeSingleNumber(numberType);\n            if (!code) {\n                break;\n            }\n            charCodes.push(code);\n            if (multiInfo?.organized && multiInfo?.lastStringLength && charCodes.length >= multiInfo?.lastStringLength) {\n                break;\n            }\n        } while(true);\n        const string = charCodes.map(code => String.fromCharCode(code)).join(\"\");\n        if (multiInfo) {\n            multiInfo.lastStringLength = string.length;\n        }\n        return string;\n    }\n\n    static selfTest() {\n        const testers: Tester[] = [\n            //  0\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(DataType.STRING,\n                    dataType => tokenEncoder.encodeDataType(dataType),\n                    reset,\n                    () => tokenDecoder.decodeDataType(),\n                );\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(DataType.UNDEFINED,\n                    dataType => tokenEncoder.encodeDataType(dataType),\n                    reset,\n                    () => tokenDecoder.decodeDataType(),\n                );\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(33,\n                    number => tokenEncoder.encodeSingleNumber(number, DataType.INT8),\n                    reset,\n                    () => tokenDecoder.decodeSingleNumber(DataType.INT8));\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction([\n                        { type: \"leaf\", value: 123 },\n                        { type: \"leaf\", value: 45 },\n                        { type: \"leaf\", value: 67 },\n                        { type: \"leaf\", value: 89 },\n                    ],\n                    header => tokenEncoder.encodeMulti(header, 0, false),\n                    reset,\n                    () => {\n                        const result: ReducedToken[] = [];\n                        tokenDecoder.decodeMulti(result, false);\n                        return result;\n                    });\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction([\n                        { type: \"leaf\", value: 1000001 },\n                        { type: \"leaf\", value: 1002000 },\n                        { type: \"leaf\", value: 1003001 },\n                    ],\n                    header => tokenEncoder.encodeMulti(header, 0, false),\n                    reset,\n                    () => {\n                        const result: ReducedToken[] = [];\n                        tokenDecoder.decodeMulti(result, false);\n                        return result;\n                    });                \n            },\n            //  5\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction([1, 2, 3, 4, 10, 20, 200],\n                    array => tokenEncoder.encodeNumberArray(array),\n                    reset,\n                    () => tokenDecoder.decodeNumberArray());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(new Array(2000).fill(null).map((_,index) => index),\n                    array => tokenEncoder.encodeNumberArray(array),\n                    reset,\n                    () => tokenDecoder.decodeNumberArray());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction([10000, -202, 3, 4, 10, 20, 3200],\n                    array => tokenEncoder.encodeNumberArray(array),\n                    reset,\n                    () => tokenDecoder.decodeNumberArray());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(\"teststring\",\n                    string => tokenEncoder.encodeString(string),\n                    reset,\n                    () => tokenDecoder.decodeString());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(\"teststring\",\n                    string => tokenEncoder.encodeString(string, DataType.STRING),\n                    reset,\n                    () => tokenDecoder.decodeString(DataType.STRING));\n            },\n            //  10\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(\"testðŸ˜€ðŸ˜ƒðŸ˜„ðŸ˜ðŸ˜†\",\n                    string => tokenEncoder.encodeString(string),\n                    reset,\n                    () => tokenDecoder.decodeString());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"object\", value: [200, 201] },\n                    o => tokenEncoder.encodeObjectToken(o),\n                    reset,\n                    () => tokenDecoder.decodeObjectToken());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"object\", value: [2000, 2001] },\n                    o => tokenEncoder.encodeObjectToken(o),\n                    reset,\n                    () => tokenDecoder.decodeObjectToken());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"object\", value: [2000, 2001] },\n                    o => tokenEncoder.encodeObjectToken(o, DataType.OBJECT_32),\n                    reset,\n                    () => tokenDecoder.decodeObjectToken(DataType.OBJECT_32));\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"split\", value: [200, 201] },\n                    o => tokenEncoder.encodeSplitToken(o),\n                    reset,\n                    () => tokenDecoder.decodeSplitToken());\n            },\n            //  15\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"split\", value: [2000, 2001] },\n                    o => tokenEncoder.encodeSplitToken(o),\n                    reset,\n                    () => tokenDecoder.decodeSplitToken());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"split\", value: [2000, 2001] },\n                    o => tokenEncoder.encodeSplitToken(o, DataType.SPLIT_32),\n                    reset,\n                    () => tokenDecoder.decodeSplitToken(DataType.SPLIT_32));\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"leaf\", value: \"tokenstring\" },\n                    o => tokenEncoder.encodeToken(o),\n                    reset,\n                    () => tokenDecoder.decodeToken());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"leaf\", value: 123.5 },\n                    o => tokenEncoder.encodeToken(o),\n                    reset,\n                    () => tokenDecoder.decodeToken());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"leaf\", value: \"ðŸ˜ðŸ˜†\" },\n                    o => tokenEncoder.encodeToken(o),\n                    reset,\n                    () => tokenDecoder.decodeToken());\n            },\n            //  20\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"array\", value: [1, 10, 20, 30, 200] },\n                    o => tokenEncoder.encodeToken(o),\n                    reset,\n                    () => tokenDecoder.decodeToken());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"array\", value: [1001, 1010, 1020, 1030, 1200] },\n                    o => tokenEncoder.encodeToken(o),\n                    reset,\n                    () => tokenDecoder.decodeToken());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"array\", value: [10010, 10100, 10300, 20000] },\n                    o => tokenEncoder.encodeToken(o),\n                    reset,\n                    () => tokenDecoder.decodeToken());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"array\", value: [10010, 10100, 10000] },\n                    o => tokenEncoder.encodeToken(o),\n                    reset,\n                    () => tokenDecoder.decodeToken());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"array\", value: new Array(260).fill(null).map((_,index) => index) },\n                    o => tokenEncoder.encodeToken(o),\n                    reset,\n                    () => tokenDecoder.decodeToken());\n            },\n            //  25\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(new Array(100).fill(null).map((_,index) => {\n                    const token: ReducedToken = {\n                        type: \"array\",\n                        value: new Array(index).fill(null).map((_, index) => index),\n                    };\n                    return token;\n                }),\n                    o => tokenEncoder.encodeTokens(o, false),\n                    reset,\n                    () => tokenDecoder.decodeTokens(false));\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(new Array(260).fill(null).map((_,index) => {\n                    const token: ReducedToken = {\n                        type: \"array\",\n                        value: new Array(index).fill(null).map((_, index) => index),\n                    };\n                    return token;\n                }),\n                    o => tokenEncoder.encodeTokens(o, false),\n                    reset,\n                    () => tokenDecoder.decodeTokens(false));\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(new Array(260).fill(null).map((_) => {\n                    const token: ReducedToken = {\n                        type: \"array\",\n                        value: [1],\n                    };\n                    return token;\n                }),\n                    o => tokenEncoder.encodeTokens(o, false),\n                    reset,\n                    () => tokenDecoder.decodeTokens(false));\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"complex\", value: [1, 2, 3, 2, 1, 2, 1, 0] },\n                    o => tokenEncoder.encodeToken(o),\n                    reset,\n                    () => tokenDecoder.decodeToken());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction({ type: \"complex\", value: \"120100310000000310000000031000003100003100000031000000031000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000031000000000010000000120103100020103100020103100031000000000002010031000000031000000003100000310000310000003100000003100000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000310000000000100000001201031000201031000201031000310000000000020100310000000310000000031000003100003100000031000000031000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000003100000000001000000012010310002010310002010310003100000000000201003100000003100000000310000031000031000000310000000031000000000000000000000000000100000000000000000000000000310000000000100000001201031000201031000201031000310000000000020100310000000310000000031000003100003100000031000000031000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000003100000000001000000012010310002010310002010310003100000000000\".split(\"\").map(a => parseInt(a)) },\n                    o => tokenEncoder.encodeToken(o),\n                    reset,\n                    () => tokenDecoder.decodeToken());\n            },\n            //  30\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction([1, 2, 3, 2, 1, 2, 1, 0],\n                    o => tokenEncoder.encodeNumberArray(o, DataType.UINT2),\n                    reset,\n                    () => tokenDecoder.decodeNumberArray(DataType.UINT2));\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction([1, 15, 12, 12, 1, 9, 1, 0],\n                    o => tokenEncoder.encodeNumberArray(o, DataType.UINT4),\n                    reset,\n                    () => tokenDecoder.decodeNumberArray(DataType.UINT4));\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(\"xyzxyzyzxxxyyyzzz\",\n                    o => tokenEncoder.encodeString(o),\n                    reset,\n                    () => tokenDecoder.decodeString());\n            },\n            (tokenEncoder, tokenDecoder, reset) => {\n                this.testAction(\"abcdeabcabcadbdddba\",\n                    o => tokenEncoder.encodeString(o),\n                    reset,\n                    () => tokenDecoder.decodeString());\n            },\n        ];\n\n        testers.forEach((tester, index) => {\n            const streamDataView = new StreamDataView();\n            const encoder = new TokenEncoder(streamDataView);\n            const decoder = new TokenEncoder(streamDataView);\n            const reset = () => streamDataView.resetOffset();\n            tester(encoder, decoder, reset);\n            console.info(`âœ… Passed test ${index}.`);\n        });\n    }\n\n    private static testAction<T>(\n            value: T,\n            encode: (value: T) => any,\n            reset: () => void,\n            decode: () => T,\n            check: (result: T, value: T) => void = (result, value) => console.assert(JSON.stringify(result) === JSON.stringify(value), `Not equal: \\n%s\\n!==\\n%s (expected)`, JSON.stringify(result), JSON.stringify(value))) {\n        encode(value);\n        reset();\n        const decoded = decode();\n        reset();\n        check(decoded, value);\n    }\n}\n","import Token, { Hash, ReducedToken } from \"../tokenizer/Token\";\nimport { Header } from \"../tokenizer/Header\";\nimport { DataType, DataTypeUtils, StructureType } from \"../compression/DataType\";\n\n/**\n * Stores all information needed to extract data.\n * \n * headerTokens: Common tokens used by all files.\n * files: array of indices that should match to string tokens within headerTokens.\n * getDataTokens: function to retrieve the tokens for each file. Pass the index that corresponds with files.\n */\nexport interface DataStore {\n    version?: string;\n    compressedSize?: number;\n    originalDataSize?: number;\n    headerTokens: ReducedToken[];\n    files: number[];\n    getDataTokens(index: number): ReducedToken[] | undefined;\n}\n\n/**\n * Reduce header from using large tokens to reduce tokens.\n */\nexport default class Reducer {\n    dataTypeUtils: DataTypeUtils;\n\n    constructor() {\n        this.dataTypeUtils = new DataTypeUtils();\n    }\n\n    /**\n     * Reduce header with smaller tokens for storage\n     * \n     * @param header Represents all data that we have.\n     * @returns DataStorage object that's the minimum we can store.\n     */\n    reduce(header: Header): DataStore {\n        console.log(\"Header\\n\", JSON.stringify(header, null, \"  \"));\n\n        const hashToIndex : Record<Hash, number>  = {};\n        //  start with header tokens\n        const headerTokens = this.createReducedHeaderTokens(\n            this.filterSplit(Object.values(header.registry)\n                .filter(token => token.files.size > 1 || token.files.has(\"header\")),\n                header.registry),\n            hashToIndex);\n\n        //  save files\n        const fileEntries = Object.entries(header.files).sort(([name1], [name2]) => name1.localeCompare(name2));\n        const files = fileEntries.map(([,token]) => hashToIndex[token.nameToken.hash]);\n\n        //  save all files separately as complex objects.\n        const dataTokens = fileEntries.map(([, {token: root}]) => {\n            const subHashToIndex = {...hashToIndex};\n            const structure: StructureType[] = [];\n            const result: ReducedToken[] = [{\n                    type: \"complex\",\n                    value: structure,\n            }];\n            this.createComplexObject(root, subHashToIndex, header.registry, headerTokens, structure, result);\n            return result;\n        });\n\n        return {\n            originalDataSize: header.originalDataSize,\n            headerTokens,\n            files,\n            getDataTokens: (index: number) => dataTokens[index],\n        };\n    }\n\n    /**\n     * Sort tokens by frequency.\n     */\n    private sortTokens(tokens: Token[]): void {\n        tokens.sort((t1, t2) => t2.count - t1.count);\n    }\n\n    /**\n     * Organize tokens in groups of 255\n     * @param tokens \n     */\n    private organizeTokens(tokens: Token[]): Token[] {\n        if (!tokens.length) {\n            return tokens;\n        }\n        const buckets: Token[][] = [];\n        tokens.forEach(token => {\n            const dataType = this.dataTypeUtils.getFullTokenDataType(token);\n            let bucket: Token[] | undefined = undefined;\n            for (let b of buckets) {\n                if (b.length < 255 && this.dataTypeUtils.getFullTokenDataType(b[0]) === dataType) {\n                    bucket = b;\n                    break;\n                }\n            }\n            if (!bucket) {\n                bucket = [];\n                buckets.push(bucket);\n            }\n            bucket.push(token);\n        });\n\n        buckets.forEach(bucket => {\n            const dataType = this.dataTypeUtils.getFullTokenDataType(bucket[0]);\n            switch (dataType) {\n                case DataType.UINT8:\n                case DataType.UINT16:\n                case DataType.UINT32:\n                case DataType.INT8:\n                case DataType.INT16:\n                case DataType.INT32:\n                case DataType.FLOAT32:\n                case DataType.FLOAT64:\n                    bucket.sort((a, b) => b.value - a.value);\n                    break;\n                case DataType.STRING:\n                case DataType.UNICODE:\n                    bucket.sort((a, b) => b.value.length - a.value.length);\n                    break;\n                case DataType.ARRAY_8:\n                case DataType.ARRAY_16:\n                case DataType.ARRAY_32:\n                    bucket.sort((a, b) => b.value.length - a.value.length)\n                    break;\n            }\n        });\n        const resultTokens: Token[] = [];\n        buckets.forEach(bucket => bucket.forEach(token => resultTokens.push(token)));\n        return resultTokens;\n    }\n\n    private filterSplit(tokens: Token[], registry: Record<Hash, Token>): Token[] {\n        for (let token of tokens) {\n            if (token.type === \"split\") {\n                const [chunskHash, separatorsHash] = token.reference!;\n                const chunksToken = registry[chunskHash];\n                const separatorsToken = registry[separatorsHash];\n                if (chunksToken.count <= token.count && separatorsToken.count <= token.count) {\n                    chunksToken.deleted = true;\n                    separatorsToken.deleted = true;\n                    token.type = \"leaf\";\n                    delete token.reference;\n                }\n            }\n        }\n        return tokens.filter(({deleted}) => !deleted);\n    }\n\n    private createReducedHeaderTokens(tokens: Token[], hashToIndex : Record<Hash, number>, offset: number = 0) {\n        this.sortTokens(tokens);\n        const organizedTokens = this.organizeTokens(tokens);\n\n        organizedTokens.forEach(({hash}, index) => hashToIndex[hash] = index + offset);\n\n        return organizedTokens.map(token => ({\n            type: token.type,\n            value: token.reference?.map(hash => hashToIndex[hash]) ?? token.value,\n        }));\n    }\n\n    /**\n     *  Traverse object to produce a set of tokens used to produce a complex object\n     * @param token Root token\n     * @param hashToIndex Hash to index mapping\n     * @param result Resulting set of tokens\n     */\n    createComplexObject(token: Token, hashToIndex: Record<Hash, number>, registry: Record<Hash, Token>, headerTokens: ReducedToken[], structure: StructureType[], resultDataTokens: ReducedToken[]): void {\n        if (hashToIndex[token.hash] >= 0) {\n            structure.push(StructureType.LEAF);\n            resultDataTokens.push({ type: \"reference\", value: hashToIndex[token.hash] });\n        } else if (token.type === \"leaf\") {\n            structure.push(this.dataTypeUtils.typeToStructureType(token.type));\n            hashToIndex[token.hash] = headerTokens.length + resultDataTokens.length;\n            resultDataTokens.push({ type: token.type, value: token.value });\n        } else if (token.type === \"split\" || token.type === \"object\" || token.type === \"array\") {\n            structure.push(this.dataTypeUtils.typeToStructureType(token.type));\n            if (token.type === \"array\") {\n                resultDataTokens.push({ type: \"leaf\", value: token.reference?.length });\n            }\n            const subTokens = token.reference?.map((hash) => registry[hash]);\n            subTokens?.forEach(token => {\n                this.createComplexObject(token, hashToIndex, registry, headerTokens, structure, resultDataTokens);\n            });\n        } else {\n            throw new Error(\"Invalid token type\");\n        }\n    }\n}","import Encoder from \"./Encoder\";\nimport * as fflate from 'fflate';\n\nexport default class FFlateEncoder implements Encoder {\n    encode(arrayBuffer: ArrayBuffer): ArrayBuffer {\n        return fflate.gzipSync(new Uint8Array(arrayBuffer)).buffer;\n    }\n    decode(arrayBuffer: ArrayBuffer): ArrayBuffer {\n        return fflate.gunzipSync(new Uint8Array(arrayBuffer)).buffer;\n    }\n\n}","export type Type = \"leaf\" | \"array\" | \"object\" | \"split\" | \"reference\" | \"complex\";\nexport type Hash = string;\n\nexport const SPLIT_REGEX = /\\W+/g;\nexport const TEST_REGEX = /(\\w{3,}\\W+){2,}|(\\W+\\w{3,}){2,}/\n\n/**\n * Token represent each chunk of data within an object.\n */\nexport default interface Token extends StoredToken {\n    hash: Hash;\n    files: Set<string>;\n    order: number;\n    count: number;\n    reference?: Hash[];\n    deleted?: boolean;\n}\n\n/**\n * A minimal version of a token, where we eliminate extra data like hash.\n */\nexport interface StoredToken {\n    type: Type;\n    value: any;\n}\n\n/**\n * Stored token with added debug field for easier debugging, and cache for extraction optimization.\n */\nexport interface ReducedToken extends StoredToken {\n    cache?: any;\n}\n\n/**\n * detect the type of a value\n *\n * @param value Value to analyze\n * @returns type of the value\n */\nexport function getType(value: any): Type {\n    if (Array.isArray(value)) {\n        return \"array\";\n    } else if (typeof value === \"object\" && value) {\n        return \"object\";\n    } else if (typeof value === \"string\" && new Set(value).size < 16) {\n        return \"leaf\";\n    } else if (typeof value === \"string\" && TEST_REGEX.test(value)) {\n        return \"split\";\n    } else {\n        return \"leaf\";\n    }\n}","import Loader, { IFetcher } from \"../io/Loader\";\nimport { Header } from \"./Header\";\nimport Token, { getType, Hash, SPLIT_REGEX } from \"./Token\";\nimport md5 from \"blueimp-md5\";\nconst TextEncoder = require('text-encoding').TextEncoder;\n\n/**\n * Class for spitting objects into tokens.\n */\nexport default class Tokenizer {\n    private loader: Loader = new Loader();\n\n    /**\n     * Load json or text files and turn them into tokens.\n     * \n     * @param files files to load and reduce.\n     */\n    async load(files: string[], fetcher?: IFetcher<string>): Promise<Header> {\n        if (files.some(file => typeof file !== \"string\")) {\n            throw new Error(\"Each argument passed to load must be a string.\");\n        }\n        const allData = await Promise.all(files.map(file => this.loader.load(file, fetcher)));\n        return this.tokenize(allData);\n    }\n\n    /**\n     * Takes a mapping of filename and their corresponding data, and turn them into tokens.\n     *\n     * @param items Mapping from filename to data.\n     * @returns All data stored as tokens.\n     */\n    tokenize(items: Record<string, any>) {\n        const header: Header = {\n            registry: {},\n            files: {},\n        };\n\n        const counter = { next: 0 };\n\n        Object.entries(items).sort((entry1, entry2) => entry1[0].localeCompare(entry2[0])).forEach(([file, value]) => {\n            header.files[file] = {\n                nameToken: this.tokenizeHelper(file, header.registry, counter, \"header\"),\n                token: this.tokenizeHelper(value, header.registry, counter, file),\n            }\n        });\n\n        const textEncoder = new TextEncoder();\n        header.originalDataSize = textEncoder.encode(JSON.stringify(items)).byteLength;\n\n        return header;\n    }\n\n    private registerToken(hash: Hash, value: any, registry: Record<Hash, Token>, counter: {next: number}, file: string, reference?: string[]) {\n        const entry = registry[hash] ?? (registry[hash] = {\n            type: getType(value),\n            hash,\n            value,\n            reference,\n            order: counter.next++,\n            count: 0,\n            files: new Set(),\n        });\n        entry.files.add(file);\n        entry.count++;\n        return entry;\n    }\n\n    private tokenizeHelper(item: any, registry: Record<Hash, Token>, counter: {next: number}, file: string): Token {\n        const type = getType(item);\n        if (type === \"array\") {\n            if (!Array.isArray(item)) {\n                throw new Error(\"item should be an array\");\n            }\n            const hashes = item.map(item => this.tokenizeHelper(item, registry, counter, file)).map(({hash}) => hash);\n            const hash = md5(hashes.join(\",\"));\n            return this.registerToken(hash, item, registry, counter, file, hashes);\n        } else if (type === \"object\") {\n            const entries = Object.entries(item);\n            const keysToken = this.tokenizeHelper(entries.map(([key]) => key), registry, counter, file);\n            const valuesToken = this.tokenizeHelper(entries.map(([,value]) => value), registry, counter, file);\n            const hash = md5(`${keysToken.hash}|${valuesToken.hash}`);\n            return this.registerToken(hash, item, registry, counter, file, [keysToken.hash, valuesToken.hash]);\n        } else if (type === \"split\") {\n            const chunks = item.split(SPLIT_REGEX);\n            const separators = item.match(SPLIT_REGEX);\n            const chunksToken = this.tokenizeHelper(chunks, registry, counter, file);\n            const separatorsToken = this.tokenizeHelper(separators, registry, counter, file);\n            const hash = md5(`${chunksToken.hash}-${separatorsToken.hash}`);\n            return this.registerToken(hash, item, registry, counter, file, [chunksToken.hash, separatorsToken.hash]);\n        } else {\n            const m = md5(JSON.stringify(item));\n            return this.registerToken(m, item, registry, counter, file);\n        }\n    }\n}","import { StructureType } from \"../compression/DataType\";\nimport { DataStore } from \"../reducer/Reducer\";\nimport { ReducedToken, Type } from \"../tokenizer/Token\";\n\n/**\n * Configuration that can be passed.\n * - cacheable: We can use cache to boost extraction speed. This uses a bit more memory.\n * This helps performance and memory, but can lead to weird side effects if the extracted object\n * gets modified.\n */\nexport interface ExtractionConfig {\n    cacheable: boolean;\n}\n\nconst DEFAULT_CONFIG: ExtractionConfig = {\n    cacheable: true,\n}\n\n/**\n * Class storing all data that can be extracted.\n */\nexport default class ExtractableData {\n    readonly extractor: Extractor = new Extractor();\n    readonly dataStore: DataStore;\n    readonly fileToSlot: Record<string, number>;\n    readonly config: ExtractionConfig;\n    readonly fileNames: string[];\n    readonly version?: string;\n    readonly originalDataSize?: number;\n    readonly compressedSize?: number;\n\n    constructor(dataStore: DataStore, config?: ExtractionConfig) {\n        this.dataStore = dataStore;\n        this.config = {\n            ...DEFAULT_CONFIG,\n            ...config,\n        };\n        this.fileNames = this.extractor.extractFileNames(dataStore.files, dataStore.headerTokens, this.config);\n        this.fileToSlot = Object.fromEntries(this.fileNames.map((file, index) => [file, index]));\n        this.version = dataStore.version;\n        this.originalDataSize = dataStore.originalDataSize;\n        this.compressedSize = dataStore.compressedSize;\n    }\n\n    /**\n     * Extract data form a stored file.\n     *\n     * @param filename filename to be extracted.\n     * @returns extracted data.\n     */\n    extract(filename: string) {\n        const slot = this.fileToSlot[filename];\n        const dataTokens = this.dataStore.getDataTokens(slot);\n        if (dataTokens) {\n            return this.extractor.extract(this.dataStore.headerTokens, dataTokens, this.config);\n        }\n    }\n\n    getHeaderTokens() {\n        return this.dataStore.headerTokens;\n    }\n}\n\nclass Extractor {\n    valueFetcher: Record<Type, undefined | ((token: ReducedToken, headerTokens: ReducedToken[], dataTokens: ReducedToken[] | undefined, config: ExtractionConfig) => any)>;\n\n    constructor() {\n        this.valueFetcher = {\n            \"array\": this.getArray.bind(this),\n            \"leaf\": this.getLeaf.bind(this),\n            \"object\": this.getObject.bind(this),\n            \"split\": this.getSplit.bind(this),\n            \"reference\": this.getReference.bind(this),\n            \"complex\": undefined,\n        };\n    }\n\n    extractFileNames(files: number[], headerTokens: ReducedToken[], config: ExtractionConfig) {\n        return files.map(index => this.extractToken(index, headerTokens, undefined, config));\n    }\n\n    extract(headerTokens: ReducedToken[], dataTokens: ReducedToken[], config: ExtractionConfig) {\n        const tokenStream = dataTokens.entries();\n        const [,complexToken] = tokenStream.next().value;\n        const structure: StructureType[] = complexToken.value;\n        const token = this.extractComplex(structure.entries(), tokenStream, headerTokens, [...dataTokens], config);\n        return token;\n    }\n\n    private extractComplex(structure: Iterator<[number, StructureType]>, tokenStream: Iterator<[number, ReducedToken]>, headerTokens: ReducedToken[], dataTokens: ReducedToken[] | undefined, config: ExtractionConfig): any {\n        const [, structureType] = structure.next().value;\n        switch (structureType) {\n            case StructureType.LEAF:\n                const [,leafToken]: [number, ReducedToken] = tokenStream.next().value;\n                const value = this.extractValueOrCache(leafToken, headerTokens, dataTokens, config, true, this.valueFetcher[leafToken.type]);\n                return value;\n            case StructureType.ARRAY:\n                const [,numToken]: [number, ReducedToken] = tokenStream.next().value;\n                const array = new Array(numToken.value).fill(null)\n                    .map(_ => this.extractComplex(structure, tokenStream, headerTokens, dataTokens, config));\n                return array;\n            case StructureType.OBJECT:\n                const keys: string[] = this.extractComplex(structure, tokenStream, headerTokens, dataTokens, config);\n                const values: any[] = this.extractComplex(structure, tokenStream, headerTokens, dataTokens, config);\n                const object = Object.fromEntries(keys.map((key, index) => [key, values[index]]));\n                return object;\n            case StructureType.SPLIT:\n                const chunks: string[] = this.extractComplex(structure, tokenStream, headerTokens, dataTokens, config);\n                const separators: string[] = this.extractComplex(structure, tokenStream, headerTokens, dataTokens, config);\n                const split = chunks.map((chunk, index) => `${chunk}${separators[index] ?? \"\"}`).join(\"\");\n                return split;\n\n        }\n    }\n\n    private extractToken(index: number, headerTokens: ReducedToken[], dataTokens: ReducedToken[] | undefined,\n            config: ExtractionConfig, allowUseCache?: boolean): any {\n        const token = index < headerTokens.length ? headerTokens[index] : dataTokens?.[index - headerTokens.length];\n        if (!token) {\n            throw new Error(\"Invalid token at index: \" + index);            \n        }\n        return this.extractValueOrCache(\n                token,\n                headerTokens,\n                dataTokens,\n                config,\n                allowUseCache,\n                this.valueFetcher[token.type]\n            );\n    }\n\n    private getLeaf(token: ReducedToken) {\n        return token.value;\n    }\n\n    private getReference(token: ReducedToken, headerTokens: ReducedToken[], dataTokens: ReducedToken[] | undefined, config: ExtractionConfig): any {\n        const index = token.value;\n        return this.extractToken(index, headerTokens, dataTokens, config);\n    }\n\n    private getArray(token: ReducedToken, headerTokens: ReducedToken[], dataTokens: ReducedToken[] | undefined, config: ExtractionConfig): any[] {\n        if (!Array.isArray(token.value)) {\n            throw new Error(\"Invalid array token\");\n        }\n        return token.value.map(index => this.extractToken(index, headerTokens, dataTokens, config));\n    }\n\n    private getObject(token: ReducedToken, headerTokens: ReducedToken[], dataTokens: ReducedToken[] | undefined, config: ExtractionConfig): object {\n        const [keyIndex, valueIndex] = token.value;\n        const keys: string[] = this.extractToken(keyIndex, headerTokens, dataTokens, config, true);\n        const values = this.extractToken(valueIndex, headerTokens, dataTokens, config);\n        return Object.fromEntries(keys.map((key, index) => [key, values[index]]));\n    }\n\n    private getSplit(token: ReducedToken, headerTokens: ReducedToken[], dataTokens: ReducedToken[] | undefined, config: ExtractionConfig): string {\n        const [chunksIndex, separatorsIndex] = token.value;\n        const chunks: string[] = this.extractToken(chunksIndex, headerTokens, dataTokens, config, true);\n        const separators: string[] = this.extractToken(separatorsIndex, headerTokens, dataTokens, config, true);\n        return chunks.map((chunk, index) => `${chunk}${separators[index] ?? \"\"}`).join(\"\");\n    }\n\n    private extractValueOrCache<T>(\n        token: ReducedToken,\n        headerTokens: ReducedToken[],\n        dataTokens: ReducedToken[] | undefined,\n        config: ExtractionConfig,\n        allowUseCache?: boolean,\n        getValue?: (token: ReducedToken, headerTokens: ReducedToken[], dataTokens: ReducedToken[] | undefined, config: ExtractionConfig) => T): T {\n        \n        if (token.cache !== undefined && allowUseCache) {\n            return token.cache;\n        }\n\n        const value = getValue!(token, headerTokens, dataTokens, config);\n        if (config.cacheable && token.type !== \"leaf\") {\n            token.cache = value;\n        }\n        return value;\n    }\n}","import Reducer, { DataStore } from \"../reducer/Reducer\";\nimport { StreamDataView } from \"stream-data-view\";\nimport Encoder from \"./Encoder\";\nimport TokenEncoder from \"./TokenEncoder\";\nimport FFlateEncoder from \"./FFlateEncoder\";\nimport Tokenizer from \"../tokenizer/Tokenizer\";\nimport ExtractableData, { ExtractionConfig } from \"../expander/Extractor\";\nimport Loader, { IFetcher } from \"../io/Loader\";\n\nconst version = \"1.1.0\";\n\nenum EncoderEnum {\n    NONE = 0,\n    FFLATE = 1,\n};\n\nconst ENCODERS: (() => Encoder | undefined)[] = [\n    () => undefined,\n    () => new FFlateEncoder(),\n]\n\nconst DEFAULT: EncoderEnum[] = [EncoderEnum.FFLATE];\n\nexport default class Compressor {\n    /**\n     * Load json or text files and compress them into one big blob.\n     * This uses the default encoders.\n     * \n     * @param files files to load.\n     */\n    async loadAndCompress(files: string[], fetcher?: IFetcher<string>, encoder: EncoderEnum[] = DEFAULT): Promise<ArrayBuffer> {\n        const tokenizer = new Tokenizer();\n        const header = await tokenizer.load(files, fetcher);\n\n        const reducer = new Reducer();\n        const dataStore = reducer.reduce(header);\n        return this.compressDataStore(dataStore, encoder);\n    }\n\n    /**\n     * Compress data into one big blob.\n     * This uses the default encoders.\n     * \n     * @param files files to load.\n     */\n    compress(data: Record<string, any>, encoder: EncoderEnum[] = DEFAULT): ArrayBuffer {\n        const tokenizer = new Tokenizer();\n        const header = tokenizer.tokenize(data);\n\n        const reducer = new Reducer();\n        const dataStore = reducer.reduce(header);\n        return this.compressDataStore(dataStore, encoder);\n    }\n    \n    async loadAndExpand(file: string, fetcher: IFetcher<ArrayBuffer> = Loader.ArrayBufferFetcher): Promise<ExtractableData> {\n        const arrayBuffer = await fetcher(file);\n        return this.expand(arrayBuffer);\n    }\n\n    expand(arrayBuffer: ArrayBuffer, config?: ExtractionConfig): ExtractableData {\n        return new ExtractableData(this.expandDataStore(arrayBuffer), config);\n    }\n\n    private compressDataStore(dataStore: DataStore, encoderEnums: EncoderEnum[] = DEFAULT): ArrayBuffer {\n        const streamDataView = new StreamDataView();\n        const tokenEncoder: TokenEncoder = new TokenEncoder(streamDataView);\n\n        //  Write header tokens\n        tokenEncoder.encodeTokens(dataStore.headerTokens, true);\n        //  Write fileNames\n        tokenEncoder.encodeNumberArray(dataStore.files);\n\n        const finalStream = new StreamDataView();\n        //  Write version\n        finalStream.setNextUint8(version.length);\n        finalStream.setNextString(version);\n\n        //  Write encoders\n        encoderEnums.forEach(encoderEnum => finalStream.setNextUint8(encoderEnum));\n        finalStream.setNextUint8(0);\n\n        const encoders: Encoder[] = encoderEnums\n            .map(encoderEnum => ENCODERS[encoderEnum]())\n            .filter((encoder): encoder is Encoder => !!encoder);\n\n        //  Write header\n        const headerBuffer = this.applyEncoders(streamDataView.getBuffer(), encoders);\n        finalStream.setNextUint32(headerBuffer.byteLength);\n        finalStream.setNextBytes(headerBuffer);\n        // console.log(\"HEADER length\", headerBuffer.byteLength);\n\n        //  Write each file's data tokens.\n        for (let index = 0; index < dataStore.files.length; index++) {\n            const subStream = new StreamDataView();\n            const subEncoder = new TokenEncoder(subStream);\n            subEncoder.encodeTokens(dataStore.getDataTokens(index)!, false);\n\n            //  save and compress buffer\n            const subBuffer = this.applyEncoders(subStream.getBuffer(), encoders);\n            finalStream.setNextUint32(subBuffer.byteLength);\n            // console.log(\"SUBBUFFER length\", index, subBuffer.byteLength);\n            finalStream.setNextBytes(subBuffer);\n        }\n        finalStream.setNextUint32(0);\n\n        //  Write original data size\n        finalStream.setNextUint32(dataStore.originalDataSize ?? 0);\n\n        return new Uint8Array(finalStream.getBuffer()).buffer;\n    }\n\n    private expandDataStore(arrayBuffer: ArrayBuffer): DataStore {\n        const compressedSize = arrayBuffer.byteLength;\n        let input = arrayBuffer;\n        const globalStream = new StreamDataView(input);\n        const version = globalStream.getNextString(globalStream.getNextUint8());\n        const decoders: Encoder[] = [];\n        do {\n            const encoderEnum = globalStream.getNextUint8();\n            if (encoderEnum === EncoderEnum.NONE) {\n                break;\n            }\n            const decoder = ENCODERS[encoderEnum]?.();\n            if (decoder) {\n                decoders.push(decoder);\n            }\n        } while(globalStream.getOffset() < globalStream.getLength());\n\n        const headerByteLength = globalStream.getNextUint32();\n        const headerBuffer = this.applyDecoders(globalStream.getNextBytes(headerByteLength).buffer, decoders);\n\n        const headerTokenEncoder = new TokenEncoder(new StreamDataView(headerBuffer));\n        const headerTokens = headerTokenEncoder.decodeTokens(true);\n        const files = headerTokenEncoder.decodeNumberArray();\n\n        const subBuffers: ArrayBuffer[] = [];\n        do {\n            const byteLength = globalStream.getNextUint32();\n            if (!byteLength) {\n                break;\n            }\n            subBuffers.push(globalStream.getNextBytes(byteLength).buffer);\n        } while(globalStream.getOffset() < globalStream.getLength())\n\n        const getDataTokens = (index: number) => {\n            const subBuffer = this.applyDecoders(subBuffers[index], decoders);\n            const streamDataView = new StreamDataView(subBuffer);\n            const tokenDecoder = new TokenEncoder(streamDataView);\n            return tokenDecoder.decodeTokens(false);\n        }\n\n        //  The remaining from streamDataView is extra. Some compressed data don't have it.\n        let originalDataSize;\n        try {\n            originalDataSize = globalStream.getNextUint32() || undefined;\n        } catch (e) {\n        }\n\n        return {\n            version,\n            originalDataSize,\n            compressedSize,\n            headerTokens,\n            files,\n            getDataTokens,\n        }\n    }\n\n    private applyEncoders(buffer: ArrayBuffer, encoders: Encoder[]): ArrayBuffer {\n        let resultBuffer = buffer;\n        encoders.forEach(encoder => {\n            resultBuffer = encoder.encode(resultBuffer);\n        });\n        return resultBuffer;\n    }\n\n    private applyDecoders(buffer: ArrayBuffer, decoders: Encoder[]): ArrayBuffer {\n        let resultBuffer = buffer;\n        decoders.forEach(decoder => {\n            resultBuffer = decoder.decode(resultBuffer);\n        });\n        return resultBuffer;\n    }\n}\n","import Loader from \"./io/Loader\";\nimport TokenEncoder from \"./compression/TokenEncoder\";\nimport Compressor from \"./compression/Compressor\";\nimport FFlateEncoder from \"./compression/FFlateEncoder\";\n\nconst exportedClasses = {\n  Loader,\n  Compressor,\n  TokenEncoder,\n  FFlateEncoder,\n}\n\nexport default exportedClasses;\n"],"names":["yaml","require","extension","file","split","pop","Loader","_proto","prototype","load","fetcher","BrowserFetcher","then","text","JSON","parse","e","Promise","reject","fetch","response","arrayBuffer","StructureType","DataType","NUMBER_DATA_TYPES","UINT8","INT8","UINT16","INT16","UINT32","INT32","FLOAT32","FLOAT64","DataTypeUtils","numberSatisfyDataType","value","dataType","hasDecimal","Math","fround","UINT2","UINT4","getBestType","array","some","number","every","_this","min","apply","max","_i","_NUMBER_DATA_TYPES","length","getNumberDataType","_i2","_NUMBER_DATA_TYPES2","type","UNDEFINED","getStringDataType","letterCodes","map","l","charCodeAt","code","STRING","UNICODE","getFullTokenDataType","token","ARRAY_8","OBJECT_8","SPLIT_8","getDataType","COMPLEX_OBJECT","indices","console","assert","EMPTY_ARRAY","offset","bestType","OBJECT_16","OBJECT_32","SPLIT_16","SPLIT_32","OFFSET_ARRAY_8","OFFSET_ARRAY_16","OFFSET_ARRAY_32","ARRAY_16","ARRAY_32","undefined","NULL","BOOLEAN_TRUE","BOOLEAN_FALSE","REFERENCE_8","REFERENCE_16","REFERENCE_32","Error","dataTypeToType","typeToStructureType","LEAF","ARRAY","OBJECT","SPLIT","MAX_ARRAY_SIZE","TokenEncoder","streamDataView","dataTypeUtils","encodeTokens","tokens","organized","pos","count","encodeMulti","decodeTokens","getOffset","getLength","decodeMulti","encodeToken","multiInfo","usedDataType","encodeDataType","encodeSingleNumber","encodeString","encodeObjectToken","encodeSplitToken","encodeArrayToken","encodeReferenceToken","encodeComplexToken","decodeToken","decodeDataType","decodeSingleNumber","decodeString","decodeObjectToken","decodeSplitToken","decodeArrayToken","decodeReferenceToken","decodeComplexToken","isOffsetDataType","arrayToken","numberType","encodeNumberArray","decodeNumberArray","objectToken","_objectToken$value","keysIndex","valuesIndex","splitToken","_splitToken$value","chunksIndex","separatorsIndex","index","structure","setNextUint8","getNextUint8","firstType","multiCount","maxCount","i","push","setNextInt8","setNextUint16","setNextInt16","setNextUint32","setNextInt32","setNextFloat32","setNextFloat64","getNextInt8","getNextUint16","getNextInt16","getNextUint32","getNextInt32","getNextFloat32","getNextFloat64","bit2ToNum","_ref","a","b","c","d","numToBit2","n","size","slice","bit4ToNum","_ref2","numToBit4","stride","transform","bytes","_iterator","_createForOfIteratorHelperLoose","_step","done","byte","sizeDiff","numbers","lastStringLength","forEach","charCodes","string","String","fromCharCode","join","selfTest","testers","tokenEncoder","tokenDecoder","reset","_this2","testAction","header","result","Array","fill","_","o","parseInt","tester","StreamDataView","encoder","decoder","resetOffset","info","encode","decode","check","stringify","decoded","Reducer","reduce","log","hashToIndex","headerTokens","createReducedHeaderTokens","filterSplit","Object","values","registry","filter","files","has","fileEntries","entries","sort","name1","name2","localeCompare","_ref3","nameToken","hash","dataTokens","_ref4","root","subHashToIndex","_extends","createComplexObject","originalDataSize","getDataTokens","sortTokens","t1","t2","organizeTokens","buckets","bucket","_buckets","resultTokens","_token$reference","reference","chunskHash","separatorsHash","chunksToken","separatorsToken","deleted","_ref5","organizedTokens","_ref6","_token$reference$map","_token$reference2","resultDataTokens","_token$reference4","_token$reference3","subTokens","_this3","FFlateEncoder","fflate","Uint8Array","buffer","SPLIT_REGEX","TEST_REGEX","getType","isArray","Set","test","TextEncoder","Tokenizer","resolve","all","loader","allData","tokenize","items","counter","next","entry1","entry2","tokenizeHelper","textEncoder","byteLength","registerToken","entry","_registry$hash","order","add","item","hashes","md5","keysToken","key","valuesToken","chunks","separators","match","m","DEFAULT_CONFIG","cacheable","ExtractableData","dataStore","config","Extractor","fileNames","extractor","extractFileNames","fileToSlot","fromEntries","version","compressedSize","extract","filename","slot","getHeaderTokens","valueFetcher","getArray","bind","getLeaf","getObject","getSplit","getReference","_proto2","extractToken","tokenStream","_tokenStream$next$val","complexToken","extractComplex","concat","_structure$next$value","structureType","_tokenStream$next$val2","leafToken","extractValueOrCache","_tokenStream$next$val3","numToken","keys","object","chunk","_separators$index","allowUseCache","_token$value","keyIndex","valueIndex","_token$value2","_separators$index2","getValue","cache","EncoderEnum","ENCODERS","DEFAULT","FFLATE","Compressor","loadAndCompress","tokenizer","reducer","compressDataStore","compress","data","loadAndExpand","ArrayBufferFetcher","expand","expandDataStore","encoderEnums","finalStream","setNextString","encoderEnum","encoders","headerBuffer","applyEncoders","getBuffer","setNextBytes","subStream","subEncoder","subBuffer","_dataStore$originalDa","input","globalStream","getNextString","decoders","_ENCODERS$encoderEnum","NONE","call","headerByteLength","applyDecoders","getNextBytes","headerTokenEncoder","subBuffers","resultBuffer","exportedClasses"],"mappings":"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"}